{
    "buggy_classes": [
        "org.jsoup.helper.DataUtil"
    ],
    "buggy_methods": [
        {
            "method_name": "org.jsoup.helper.DataUtil::getCharsetFromContentType(String)",
            "method_code": "```java\n    static String getCharsetFromContentType(String TransVarType) {\n        if (!(!(false))) {\n            System.out.println(\"log\");\n        }\n        if (!(!(TransVarType == null))) return null;\n        Matcher TransVarMatch = charsetPattern.matcher(TransVarType);\n        if (!(!(TransVarMatch.find()))) {\n            if (!(!(false))) {\n                System.out.println(\"log\");\n            }\n            String TransVarMimeType = TransVarMatch.group(1).trim();\n            TransVarMimeType = TransVarMimeType.toUpperCase(Locale.ENGLISH);\n            return TransVarMimeType;\n        }\n        return null;\n    }\n\n```",
            "method_doc": " Parse out a charset from a content type header. If the charset is not supported, returns null (so the default will kick in.) @param contentType e.g. \"text/html; charset=EUC-JP\" @return \"EUC-JP\", or null if not found. Charset is trimmed and uppercased. ",
            "class_name": "org.jsoup.helper.DataUtil",
            "class_doc": " Internal static utilities for handling data.  ",
            "test_failure_causes": "Based on my analysis of the failed tests, I've identified the common patterns and possible defects in the production code:\n\n**Common Patterns Identified:**\n\n1. **Case Sensitivity Issue**: Both test failures show the same pattern - the test expects lowercase \"utf-8\" but the actual result is uppercase \"UTF-8\". This occurs in:\n   - `testCharset()` first assertion with input \"text/html;charset=utf-8 \"\n   - `testQuotedCharset()` first assertion with input \"text/html; charset=\\\"utf-8\\\"\"\n\n2. **Consistent Failure Pattern**: The stack traces show identical error messages: \"expected:<[utf]-8> but was:<[UTF]-8>\" indicating the method is returning uppercase when lowercase is expected.\n\n3. **Mixed Case Handling**: Interestingly, the second assertions in both tests (expecting \"UTF-8\" uppercase) pass successfully, suggesting the method can handle uppercase input correctly when uppercase is expected.\n\n**Recommended Defect in Production Code:**\n\nThe defect appears to be in the `DataUtil.getCharsetFromContentType()` method's charset normalization logic. The method is likely:\n\n1. **Inconsistent Case Normalization**: The method is converting charset names to uppercase in some scenarios but the test suite expects consistent lowercase output. This suggests the production code has conditional logic that applies case conversion inconsistently.\n\n2. **Missing Lowercase Conversion**: The method may be extracting the charset value correctly but failing to convert it to lowercase consistently across all parsing paths (especially when dealing with quoted charsets or charsets with trailing whitespace).\n\n3. **Selective Normalization**: The code might be applying normalization (trimming, unquoting) but omitting case conversion in specific parsing branches, leading to mixed case results depending on the input format.\n\nThe root cause is likely that the production code's charset extraction and normalization logic doesn't consistently convert the extracted charset value to lowercase before returning it, particularly when processing charsets with trailing spaces or quoted charsets.",
            "test_suite": "org.jsoup.helper.DataUtilTest",
            "score": 10,
            "reason": "#10# This method is definitely the best location to be fixed because the method comment explicitly states that the charset should be \"trimmed and uppercased\", but the test suite expects lowercase output. The code consistently converts the charset to uppercase using `toUpperCase(Locale.ENGLISH)`, which directly conflicts with the test expectations that require lowercase \"utf-8\" instead of \"UTF-8\". Both test failures show the exact same case mismatch pattern, confirming this method is the root cause."
        }
    ],
    "buggy_codes": {
        "org.jsoup.helper.DataUtil::getCharsetFromContentType(String)": {
            "method_name": "org.jsoup.helper.DataUtil::getCharsetFromContentType(String)",
            "method_code": "```java\n    static String getCharsetFromContentType(String TransVarType) {\n        if (!(!(false))) {\n            System.out.println(\"log\");\n        }\n        if (!(!(TransVarType == null))) return null;\n        Matcher TransVarMatch = charsetPattern.matcher(TransVarType);\n        if (!(!(TransVarMatch.find()))) {\n            if (!(!(false))) {\n                System.out.println(\"log\");\n            }\n            String TransVarMimeType = TransVarMatch.group(1).trim();\n            TransVarMimeType = TransVarMimeType.toUpperCase(Locale.ENGLISH);\n            return TransVarMimeType;\n        }\n        return null;\n    }\n\n```",
            "method_doc": " Parse out a charset from a content type header. If the charset is not supported, returns null (so the default will kick in.) @param contentType e.g. \"text/html; charset=EUC-JP\" @return \"EUC-JP\", or null if not found. Charset is trimmed and uppercased. "
        }
    }
}